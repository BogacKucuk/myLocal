@Test
@DisplayName("createDocumentDB2Record - GroupList mapping kontrolü")
void givenRequestWithGroupList_whenCreateDocumentDB2Record_thenGroupListMappedCorrectly() {
    // Given
    when(goldDocumentGrpcServiceBlockingStub.createDocumentDB2Record(any(CreateDocumentDB2Request.class)))
            .thenReturn(grpcResponse);

    // When
    goldDocumentService.createDocumentDB2Record(requestDto);

    // Then
    verify(goldDocumentGrpcServiceBlockingStub).createDocumentDB2Record(
            argThat(request -> {
                // GroupList'in varlığını kontrol et
                if (!request.hasGroupList()) {
                    return false;
                }
                
                // GroupList items sayısını kontrol et
                if (request.getGroupList().getGroupListItemsCount() == 0) {
                    return false;
                }
                
                // İlk item'ı kontrol et
                try {
                    boolean documentIdValid = request.getGroupList()
                            .getGroupListItems(0)
                            .getIdCardTxn()
                            .getDocumentId()
                            .equals("20240110104819081704");
                    
                    boolean docPersonTypeValid = request.getGroupList()
                            .getGroupListItems(0)
                            .getIdCardTxn()
                            .getDocPersonType()
                            .equals("01");
                    
                    boolean customerNumValid = request.getGroupList()
                            .getGroupListItems(0)
                            .getCustomerNum() == 45003398;
                    
                    return documentIdValid && docPersonTypeValid && customerNumValid;
                } catch (Exception e) {
                    return false;
                }
            })
    );
}



------------------------------------------------------------------------------------


@Test
@DisplayName("createDocumentDB2Record - GroupList mapping kontrolü")
void givenRequestWithGroupList_whenCreateDocumentDB2Record_thenGroupListMappedCorrectly() {
    // Given
    when(goldDocumentGrpcServiceBlockingStub.createDocumentDB2Record(any(CreateDocumentDB2Request.class)))
            .thenReturn(grpcResponse);

    // When
    CreateDocumentDB2ResponseDto response = goldDocumentService.createDocumentDB2Record(requestDto);

    // Then
    assertThat(response).isNotNull();
    verify(goldDocumentGrpcServiceBlockingStub, times(1))
            .createDocumentDB2Record(any(CreateDocumentDB2Request.class));
    
    // Request DTO'nun groupList'inin doğru olduğunu kontrol et
    assertThat(requestDto.getGroupList()).isNotNull();
    assertThat(requestDto.getGroupList().getGroupListItems()).hasSize(1);
    assertThat(requestDto.getGroupList().getGroupListItems().get(0).getCustomerNum()).isEqualTo(45003398);
    assertThat(requestDto.getGroupList().getGroupListItems().get(0).getIdCardTxn().getDocumentId())
            .isEqualTo("20240110104819081704");
}
