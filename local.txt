spring:
  main:
    allow-bean-definition-overriding: true

  application:
    name: COREBANKING.SAFEDEPOSITBOX.safedepositbox-be

  profiles:
    active: local

  datasource:
    driver-class-name: oracle.jdbc.OracleDriver
    url: jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=oprkbarcdbt.sys.yapikredi.com.tr)(PORT=1818)))(CONNECT_DATA=(SERVICE_NAME=SRVTEST_TBU)))
    username: SAFEDEPOSITBOX
    password: safetbu1*
    hikari:
      connection-test-query: SELECT 1 FROM DUAL
      minimum-idle: 1
      maximum-pool-size: 20
      max-lifetime: 60000
      idle-timeout: 10000
      connection-timeout: 10000
      data-source-properties:
        oracle.jdbc.ReadTimeout: 10000
        oracle.net.READ_TIMEOUT: 10000
        oracle.net.CONNECT_TIMEOUT: 10000
        "[v$session.program]": ${spring.application.name}

  # Spring Batch tablo yaratma ayarı:
  batch:
    jdbc:
      initialize-schema: always
    # Eğer bu tabloyu production'da otomatik oluşturmak istemiyorsanız,
    # dev/test environment'larda kullanın.

  jpa:
    show-sql: false
    generate-ddl: false
    database-platform: org.hibernate.dialect.OracleDialect
    properties:
      hibernate:
        enable_lazy_load_no_trans: true
        jdbc:
          batch_size: 100
        order_inserts: true
        order_updates: true

server:
  port: 55400

eureka:
  client:
    enabled: false

runtime:
  platform: local

management:
  endpoints:
    web:
      exposure:
        include: '*'

harmoni:
  adapter:
    restendpoint: http://betest.yapikredi.com.tr/Harmoni/rest
    #restendpoint: http://localhost:9080/HMN_INF_WSServer/rest

safedepositbox:
  caches:
    SafeDepositBoxOneDayCache:
      timeToLive: 1d
      cacheNullValues: false
    SafeDepositBoxWeeklyCache:
      timeToLive: 7d
      cacheNullValues: false

redis:
  readTimeout: 100ms
  connectTimeout: 100ms

architecture:
  redis:
    service:
      name: COREBANKING.SAFEDEPOSITBOX.Redis

messaging:
  queues:
    safeDepositBoxErrorLogQueue:
      name: safeDepositBox_error_log_to_generation_q
      routingKey: safeDepositBox_error_log_to_generation_rk
      enabled: true
      durable: false
      exchange: 
        name: safeDepositBox_error_log_generation_exchange
        durable: false
        type: direct
        retryCount: 1
      arguments: 
        x-message-ttl: 30000
        x-queue-mode: lazy 
    safeDepositBoxInfoLogQueue:
      name: safeDepositBox_info_log_to_generation_q
      routingKey: safeDepositBox_info_log_to_generation_rk
      enabled: true
      durable: false
      exchange: 
        name: safeDepositBox_info_log_generation_exchange
        durable: false
        type: direct
        retryCount: 1
      arguments: 
        x-message-ttl: 30000
        x-queue-mode: lazy
    jobStatistic:
      name: safedeposit_job_statistic_q
      routingKey: safedeposit_job_statistic_rk
      enabled: true
      durable: false
      exchange:
        name: safedeposit_job_statistic_exchange
        durable: false
        type: direct
        retryCount: 1
      arguments:
        x-message-ttl: 30000
        x-queue-mode: lazy
  environments:
    local:
      host: localhost
      vhost: '/'
      username: admin
      userspec: passrmq01
    dev:
      host: 10.59.9.53
      port: 5577
      vhost: gise-vhost
      username: admin
      userspec: passrmq01
  rabbit:
    useRabbitFlag: true
    environment: dev
    service: COREBANKING.SAFEDEPOSITBOX.RabbitMQ

resilience4j.ratelimiter:
  instances:
    rateLimiterForErrorLogger:
      limitForPeriod: 10
      limitRefreshPeriod: 1s
      timeoutDuration: 0
      registerHealthIndicator: true
      eventConsumerBufferSize: 10
    rateLimiterForInfoLogger:
      limitForPeriod: 10
      limitRefreshPeriod: 500ms
      timeoutDuration: 0
      registerHealthIndicator: true
      eventConsumerBufferSize: 10

loginfrastructure:
  asynchronous:
    corePoolSize: 1
    maxPoolSize: 3
    threadQueueCapacity: 500
    threadPoolKeepAliveSeconds: 60
  loggers:
    sherlog:
      enabled: true
    safeDepositBoxlog:
      enabled: true
      services:
        DefaultService:
          isLogActive: false
          logLevel: ERROR
        FeignClient:
          isLogActive: false
          logLevel: ERROR
        RestController:
          isLogActive: false
          logLevel: ERROR
    flowXKafkaLog:
      enabled: true
      queueTimeout: 2000ms

kafka:
  safeDepositBox:
    platform: ABCD
    address: ovrmonkfkmng1.kfs.local:9092, ovrmonkfkmng2.kfs.local:9092, ovrmonkfkmng3.kfs.local:9092
    topic: SAFEDEPOSITBOX
    prefix: FLOWX
    postfix: TST
    retry:
      interval: 2000
      maxAttempts: 3
